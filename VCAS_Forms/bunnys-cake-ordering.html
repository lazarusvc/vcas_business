<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
<script src="https://code.jquery.com/jquery-3.1.0.js"></script>
  
</head>
<body>
<form action="/formsData/Create" method="POST" enctype="multipart/form-data" id="bunnyForm">

<!-- {REQUIRED} Form data relational ID ------------------------------------------- -->
<input type="hidden" name="FK_formsId" value="8"/>

<!-- {REQUIRED} Calendar default event color -------------------------------------- --> 
<input type="hidden" name="txtInput_13" value="#3788d8"/>

<!-- POS Invoice logic - Input Fields --------------------------------------------- -->
<input type="hidden" name="txtInput_14" id="txtInput_14" /><!-- dbo.capture_payments - payer -->
<input type="hidden" name="txtInput_15" id="txtInput_15" value="notes: Cake order -- form entry" /><!-- dbo.capture_payments - comment -->
<input type="hidden" name="txtInput_16" id="txtInput_16" value="6023" /><!-- dbo.capture_payments - FK_items 8 for DB vouchcast01 -->
<input type="hidden" name="txtInput_17" id="txtInput_17" /><!-- dbo.capture_payments - amount -->
<input type="hidden" name="txtInput_18" id="txtInput_18" /><!-- dbo.capture_payments - received_amount -->

<!-- {REQUIRED} Customer name logic - Input Fields --------------------------------- -->
<textarea type="hidden" class="form-control" id="txtAreaInput_03" name="txtAreaInput_03" style="display:none;"></textarea>

<div class="vc-form">
    <div class="">
        <h1>Bunny's<br/>Cake Order Form</h1></div>
    <div>
	<h3>Customer Info::</h3>
	<hr/>
		<fieldset>
		  <legend>+NEW</legend>

		  <div>
			<input type="checkbox" id="newCus"/>
			<label for="new">customer</label>
		  </div>
		</fieldset><br/>
		<div class="formbuilder-select form-group field-select-1676509446775">
			<label for="select-1676509446775" class="formbuilder-select-label">Customer list:</label>
			<select class="form-control" name="selectInput_03" id="selectInput_03">
				<option value="Chocolate" selected="true" id="select-1676509446775-0">-- Select --</option>
			</select>			
		</div>	
        <label for="text-1676508193795" class="formbuilder-text-label">Name:</label>
        <input type="text" placeholder="e.g. Jane Doe" class="form-control" name="txtInput_01" access="false" id="txtInput_01">
    </div>
    <div class="formbuilder-text form-group field-text-1676509822703">
        <label for="text-1676509822703" class="formbuilder-text-label">Name (on behalf of):</label>
        <input type="text" placeholder="e.g. Jody Doe" class="form-control" name="txtInput_02" access="false" id="text-1676509822703">
    </div>
    <div class="formbuilder-text form-group field-text-1676508199466">
        <label for="text-1676508199466" class="formbuilder-text-label">Contact #:</label>
        <input type="tel" placeholder="(767)555-5555" class="form-control" name="txtInput_03" access="false" id="txtInput_03">
    </div>
    <div class="formbuilder-text form-group field-text-1676508460512">
        <label for="text-1676508460512" class="formbuilder-text-label">Email Address:</label>
        <input type="email" placeholder="jane.doe@bunnyscakes.com" class="form-control" name="txtInput_04" access="false" id="text-1676508460512">
    </div>
    <div class="formbuilder-text form-group field-text-1676509822703">
		<input type="checkbox" id="checkInput_01" name="checkInput_01" value="Male">
		<label for="checkInput_01"> Male:</label><br>
		<input type="checkbox" id="checkInput_02" name="checkInput_02" value="Female">
		<label for="checkInput_02"> Female:</label><br>
    </div>		
    <div class="formbuilder-text form-group field-text-1676509822703">
        <label for="text-1676509822703" class="formbuilder-text-label">Age Range:</label>
        <input type="number" placeholder="e.g. 12" class="form-control" name="txtInput_12" access="false" id="text-1676509822703">
    </div>		
	<h3>Cake Details::</h3>
	<hr/>
    <div class="formbuilder-date form-group field-date-1676508211598">
        <label for="date-1676508211598" class="formbuilder-date-label">Pick up:</label>
        <input type="datetime-local" class="form-control" name="txtInput_05" access="false" id="date-1676508211598">
    </div>
    <div class="formbuilder-text form-group field-text-1676508882563">
        <label for="text-1676508882563" class="formbuilder-text-label">Cost ($):</label>
        <input type="text" class="form-control" name="txtInput_06" access="false" id="txtInput_06">
    </div>
    <div class="formbuilder-text form-group field-text-1676509128360">
        <label for="text-1676509128360" class="formbuilder-text-label">Deposited ($):</label>
        <input type="text" class="form-control" name="txtInput_07" access="false" id="txtInput_07">
    </div>
    <div class="formbuilder-text form-group field-text-1676509192502">
        <label for="text-1676509192502" class="formbuilder-text-label">Balance ($):</label>
        <input type="text" class="form-control" name="txtInput_08" access="false" id="txtInput_08" readonly="readonly">
    </div>
    <div class="formbuilder-select form-group field-select-1676509381942">
        <label for="select-1676509381942" class="formbuilder-select-label">Number of Layers:</label>
        <select class="form-control" name="selectInput_01" id="selectInput_01 select-1676509381942">
            <option value="1" selected="true" id="select-1676509381942-0">1</option>
            <option value="2" id="select-1676509381942-1">2</option>
            <option value="3" id="select-1676509381942-2">3</option>
            <option value="4" id="select-1676509381942-3">4</option>
            <option value="5" id="select-1676509381942-4">5</option>
        </select>
    </div>
    <div class="formbuilder-select form-group field-select-1676509446775">
        <label for="select-1676509446775" class="formbuilder-select-label">Flavour:</label>
        <select class="form-control" name="selectInput_02" id="selectInput_02 select-1676509446775">
            <option value="Chocolate" selected="true" id="select-1676509446775-0">Chocolate</option>
            <option value="Vanilla" id="select-1676509446775-1">Vanilla</option>
            <option value="Fruit" id="select-1676509446775-2">Fruit</option>
            <option value="Red Velvet" id="select-1676509446775-3">Red Velvet</option>
        </select>
    </div>
    <div class="formbuilder-text form-group field-text-1676509617623">
        <label for="text-1676509617623" class="formbuilder-text-label">Icing:</label>
        <input type="text" class="form-control" name="txtInput_09" access="false" id="txtInput_09 text-1676509617623">
    </div>
    <div class="formbuilder-text form-group field-text-1676509649177">
        <label for="text-1676509649177" class="formbuilder-text-label">Cake Theme:</label>
        <input type="text" class="form-control" name="txtInput_10" access="false" id="txtInput_10 text-1676509649177">
    </div>
    <div class="formbuilder-text form-group field-text-1676509652223">
        <label for="text-1676509652223" class="formbuilder-text-label">Cake Shape:</label>
        <input type="text" class="form-control" name="txtInput_11" access="false" id="txtInput_11 text-1676509652223">
    </div>
    <div class="formbuilder-textarea form-group field-textarea-1676509658342">
        <label for="textarea-1676509658342" class="formbuilder-textarea-label">Writing on cake:</label>
        <textarea type="textarea" class="form-control" name="txtAreaInput_01" access="false" id="txtAreaInput_01 textarea-1676509658342"></textarea>
    </div>
    <div class="formbuilder-textarea form-group field-textarea-1676509731996">
        <label for="textarea-1676509731996" class="formbuilder-textarea-label">Brief description of cake (if necessary):</label>
        <textarea type="textarea" class="form-control" name="txtAreaInput_02" access="false" id="txtAreaInput_02"></textarea>
    </div>
	<div class="form-group files">
		<label>Attach (Image) Reference for cake:</label><br />
		<input type="file" class="form-control" name="fileInput_01" id="fileInput_01">
	</div>	
	<h3>After Sale Service::</h3>
	<hr/>
    <div class="formbuilder-date form-group field-date-1676509958304">
        <label for="date-1676509958304" class="formbuilder-date-label">Call Date:</label>
        <input type="date" class="form-control" access="false" id="date-1676509958304">
    </div>
    <div class="formbuilder-text form-group field-text-1676509966990">
        <label for="text-1676509966990" class="formbuilder-text-label">Employee:</label>
        <input type="text" class="form-control"  access="false" id="text-1676509966990">
    </div>
    <div class="">
        <p access="false" id="control-380292">
            <div>Good day. I am calling from Bunny’s Cakes and Catering. My name is {You Name}. Am I speaking to {Buyer}</div>
            <div>You purchased a cake on {Purchase Date} I am calling to find out if you are the person you bought it for {Customer}, did {Customer} enjoyed the cake</div>
        </p>
    </div>
    <div class="formbuilder-text form-group field-text-1676510166580">
        <label for="text-1676510166580" class="formbuilder-text-label">Customers comment:</label>
        <textarea type="textarea" class="form-control"></textarea>
    </div>
    <div class="">
        <p access="false" id="control-8800217">
            <div>Thanks for choosing Bunny’s. Please like and rate our face book page for a chance to entire into our</div>
            <div>monthly draws.</div>
        </p>
    </div>
    <div class="formbuilder-button form-group field-button-1676508942222">
        <input type="submit" value="Submit" class="btn-success btn" name="button-1676508942222" access="false" style="success" id="button-1676508942222" />
    </div>
</div>
</form>
<script>
	// Description logic
    // =========================================	
    $("#txtInput_03").on('change', function () {
      $("#txtAreaInput_03").html($("#txtInput_01").val() + " " + $("#txtInput_03").val());
	  $("#txtInput_14").val($("#txtInput_01").val());
    });
	// checkbox check or not check logic
    // =========================================		
	if($("#inputCheck_01").is(':checked')) {
	  $("#inputCheck_02").attr("checked", false); 
	}
	if($("#inputCheck_02").is(':checked')) {
	  $("#inputCheck_01").attr("checked", false); 
	}	
	// amount_received
	// ========================================
	var bal = 0;
	$("#txtInput_07").on('change', function () {
		bal = $("#txtInput_07").val() - $("#txtInput_06").val();
		$("#txtInput_08").val(bal);
		
		$("#txtInput_17").val($("#txtInput_06").val());
		$("#txtInput_18").val($("#txtInput_07").val());
	});
	
	
	// create invoice
	// =======================================
	$("#bunnyForm").submit(function() {
		$.ajax({
			url: '/capture_payments/CreateForm',
			type: "POST",
			data: $(this).serialize(),
			success: function () {
                // some stuff
			}
		});	  
	});
	
	// FETCH Customers
	// =============================================================
	$.ajax({
		url: "/customer/Json",
		type: "GET",
		success: function (result) {
			$.each(result, function (k, v) {
				$("#selectInput_03").append('<option value="' + v.firstName + ',' + v.lastName + ',' + v.phone + ',' + v.email +'">' + v.firstName +  ' ' + v.lastName +'</option>');					
			});			
		}		
	});
	$("#selectInput_03").on('keyup, change', function() {
         var array = $(this).val().split(",");
		$("#txtInput_01").val(array[0] + ' ' + array[1]);
		$("#txtInput_03").val(array[2]);
		$("#txtInput_04").val(array[3]);
		$("#txtAreaInput_03").html($("#txtInput_01").val() + " " + $("#txtInput_03").val());
	});		
	// CREATE Customers
	// ==================================
	$('#newCus').change(function () {
		if ($(this).is(":checked")) {
			Metro.dialog.create({
				closeButton: true,
				clsTitle: "bg-green fg-white",
				title: "<span class='mif-user-plus'></span> New Customer",
				content: "<div class=form-horizontal><div class=grid style=background:#fff;border-radius:10px;width:100%;padding:20px><div class=row><div class=cell-12><form method=POST><input name=firstName data-label='First Name:'data-role=materialinput id=firstName placeholder='Enter First Name'required> <input name=lastName data-label='Last Name:'data-role=materialinput id=lastName placeholder='Enter Last Name'required> <input name=address data-label=Address: data-role=materialinput id=address placeholder=Address> <input name=state data-label=State: data-role=materialinput id=state placeholder=State> <input name=phone data-label='Phone Number:'data-role=materialinput id=phone placeholder='Enter Phone Number'required> <input name=email data-label=Email: data-role=materialinput id=email placeholder='Enter Email'type=email> <input name=FK_Location type=hidden></form></div></div></div></div>",
				actions: [
					{
						caption: "Finish & Save",
						cls: "primary",
						onclick: function () {
								var formData =
								{
									firstName: $("#firstName").val(),
									lastName: $("#lastName").val(),
									address: $("#address").val(),
									state: $("#state").val(),
									phone: $("#phone").val(),
									email: $("#email").val(),
									FK_Location: $("#FK_Locaion").val()
								};

								$.ajax({
									url: '/customer/Create/',
									type: "POST",
									data: formData,
									success: function () {
										window.location.reload();
									}
							});
						}
					}
				]
			});
		}
    }); 
</script>


</body>
</html>